# Excel AI 插件用户指南

## 1. 简介
本插件允许您在 Excel 中直接调用 AI 模型（如 GPT-4o）来处理表格数据、提取图片信息或生成内容。

## 2. 首次设置 (API 配置)
在使用插件之前，您需要配置 AI 服务的 API Key。

1.  点击侧边栏中的 **"⚙️ Settings"** 按钮打开设置面板。
2.  **API URL**: 输入 API 服务地址。
    *   OpenAI: `https://api.openai.com/v1`
    *   火山引擎 (Ark): `https://ark.cn-beijing.volces.com/api/v3` (示例，请以官方文档为准)
    *   其他兼容 OpenAI 协议的中转服务地址。
3.  **API Key**: 输入您的 API 密钥 (sk-...)。
4.  **Model**: 输入模型名称。
    *   OpenAI: `gpt-4o`, `gpt-4-turbo`
    *   火山引擎: 输入您的 Endpoint ID (例如 `ep-20240604...`)
5.  点击底部的 **"Save Settings"** 按钮保存。配置将永久保存，下次无需重新输入。

## 3. 功能使用

### 3.1 智能填充 (Smart Fill)
1.  **选择区域**: 在 Excel 中选中包含数据的单元格，或者选中您希望填充结果的空白区域。
2.  **捕获**: 点击 **"Capture Selection"**。插件会记录选区位置，并对选区进行截图（用于视觉识别）。
3.  **提供上下文 (可选)**:
    *   **拖拽文件**: 将 PDF、文本文件、CSV 或图片拖入 "Drag & Drop" 区域。
    *   **粘贴文本**: 在 "Or paste text" 文本框中直接粘贴文字信息。
4.  **输入指令 (Prompt)**:
    *   从下拉框选择预设指令（如 "Invoice Extraction"）。
    *   或者在文本框中输入您的自定义需求（例如：“把这张图片里的表格转成 Excel 数据”）。
5.  **运行**: 点击 **"Generate & Fill"**。
    *   插件会读取选区截图、上传的文件和您的指令，发送给 AI。
    *   AI 处理完成后，数据会自动填入 Excel 表格中。

### 3.2 Prompt 管理
*   **保存**: 输入好用的指令后，点击 "Save" 按钮，输入名称即可保存为预设。
*   **删除**: 选中不需要的预设，点击 "Del" 按钮删除。

## 4. 常见问题

*   **报错 "未能创建 SSL/TLS 安全通道"**: 这是网络协议问题，插件已自动修复。如果仍出现，请确保您的网络环境允许访问 API 地址。
*   **图片无法识别**: 请确保您使用的模型（如 `gpt-4o`）支持视觉功能。普通模型（如 `gpt-3.5`）无法查看截图。
*   **按钮点不动**: 如果正在生成中，按钮会被禁用。请等待 "Done!" 提示出现。

## 5. 数据隐私
插件直接与您配置的 API 端点通信。您的数据（截图、文本）仅发送给该 API 服务商，不会经过任何第三方服务器。
